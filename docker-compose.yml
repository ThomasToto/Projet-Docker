version: "3"
services:
  server:
    build: server/
    container_name: Serveur
    command: python ./server.py
    ports:
      - 1234:1234
  
  client:
    build: client/
    container_name: Client
    command: python ./client.py
    network_mode: host
    depends_on:
      - server
  
  firewall:
    build: firewall/
    container_name: Firewall
    cap_add:
      - NET_ADMIN
    sysctls:
      - net.ipv4.ip_forward=1
      #- net.ipv4.tcp_timestamps=0
    command: >
      bash -c "./clean.sh && ./firewall.sh"
    depends_on:
      - client 
